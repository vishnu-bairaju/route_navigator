(this["webpackJsonproute-navigator"]=this["webpackJsonproute-navigator"]||[]).push([[0],{64:function(e,t,s){},66:function(e,t,s){},67:function(e,t,s){},68:function(e,t,s){},69:function(e,t,s){},76:function(e,t,s){},77:function(e,t,s){},78:function(e,t,s){"use strict";s.r(t);var i=s(1),n=s(35),c=s(2),a=s(3),o=s(11),l=s(5),r="CREATE_ROUTE",u="DELETE_ROUTE",d="EDIT_ROUTE",j={routes:[]};var b=Object(o.a)({routeReducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:j,t=arguments.length>1?arguments[1]:void 0,s=function(e,t){var s=[];return e.forEach((function(e){e.id!==t.id&&s.push(e)})),s},i=function(e,t){var s=[];return e.forEach((function(e){e.id===t.id?s.push(t):s.push(e)})),s},n=!1;switch(e.routes.forEach((function(e){e.id===t.payload.id&&(n=!0)})),t.type){case r:console.log(e.routes);var c=e;return n||(c={routes:[].concat(Object(l.a)(e.routes),[t.payload])}),c;case d:var a=i(e.routes,t.payload);return{routes:Object(l.a)(a)};case u:var o=s(e.routes,t.payload);return{routes:Object(l.a)(o)};default:return e}}}),O=b,p=Object(o.b)(O),h=s(12),f=s(4),v=(s(51),s(6)),m=s.n(v),x=s(19),S=s.n(x),g=(s(64),s(0)),N=function(e){var t=e.children,s=Object(i.useState)(!1),n=Object(c.a)(s,2),a=n[0],o=n[1];return Object(g.jsx)(g.Fragment,{children:Object(g.jsxs)("div",{className:"accordion-wrapper",children:[Object(g.jsx)("div",{className:"accordion-header",onClick:function(){o((function(e){return!e}))},children:Object(g.jsx)("div",{className:"stop-header",children:"Stop Header"})}),Object(g.jsx)("div",{className:"accordion-content ".concat(a?"show":""),children:t})]})})},R=(s(66),function(e){var t=e.setStops,s=e.index,n=e.setStopDetailList,a=e.stop,o=e.stopDetailList,l=e.setActualStops,r=e.setIsNewStopRequested,u=e.isNewStopRequested,d=e.isNewStop,j=Object(i.useState)(null),b=Object(c.a)(j,2),O=b[0],p=b[1],h=Object(i.useState)(null),f=Object(c.a)(h,2),v=f[0],m=f[1],x=Object(i.useState)(""),S=Object(c.a)(x,2),N=S[0],R=S[1],D=Object(i.useState)(!1),L=Object(c.a)(D,2);L[0],L[1];return console.log("rendered-stop - ",a),Object(g.jsxs)("form",{className:"field-form",children:[Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{className:"field-label",children:"Stop Id"}),Object(g.jsx)("input",{value:a?a.id:"STOP-"+s})]}),Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{className:"field-label",children:"Stop Name"}),Object(g.jsx)("input",{onChange:function(e){R(e.target.value)},value:a&&a.addedToRoute&&a.name})]}),Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{className:"field-label",children:"Latitude"}),Object(g.jsx)("input",{onChange:function(e){p(e.target.value)},value:a&&a.addedToRoute&&a.latitude})]}),Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{className:"field-label",children:"Longitude"}),Object(g.jsx)("input",{onChange:function(e){m(e.target.value)},value:d?v:a.longitude})]}),Object(g.jsxs)("div",{className:"btn-container",children:[Object(g.jsx)("div",{onClick:function(){return function(e){if(t((function(e){return e-1})),!u&&e&&e.addedToRoute){var s=[];o.forEach((function(t,i){t.id!==e.id&&s.push(t)})),n(s),l((function(e){return e-1}))}else r((function(e){return!e}))}(a)},className:"btn",children:"remove"}),Object(g.jsx)("div",{onClick:function(e){var t={id:"STOP-"+s,name:N,longitude:v,latitude:O,addedToRoute:!0};n((function(e){return e.push(t),e})),l((function(e){return e+1})),r((function(e){return!e})),e.preventDefault()},className:a&&a.addedToRoute?"hide":"btn",children:"Add"})]})]})}),D={routeAction:{createRoute:function(e){return console.log("Create Route",e),{type:r,payload:e}},editRoute:function(e){return console.log("Edit Route",e),{type:d,payload:e}},deleteRoute:function(e){return{type:u,payload:e}}}},L=(s(67),function(e){var t=e.action,s=e.uniqueId,n=(e.stops,e.setStopDetailList),o=e.setStops,l=e.stopDetailList,r=e.setActualStops,u=e.setUniqueId,d=e.routes,j=e.isEdit,b=e.EditRoute,O=e.setIsEdit,p=Object(i.useState)(!1),h=Object(c.a)(p,2),f=h[0],v=h[1],m=Object(i.useState)(b&&b.name||""),x=Object(c.a)(m,2),S=x[0],L=x[1],w=Object(i.useState)(b&&b.routeDirection||"Up"),y=Object(c.a)(w,2),E=y[0],k=y[1],I=Object(i.useState)(b&&b.routeStatus||"active"),A=Object(c.a)(I,2),T=A[0],C=A[1],q=Object(i.useState)((new Date).getTime()),U=Object(c.a)(q,2),V=U[0],K=U[1],_=Object(a.b)();return console.log("store routelist",d),Object(i.useEffect)((function(){n(b?b.stops:[])}),[!!j]),console.log("stop details",l),Object(g.jsx)("div",{className:"form-wrapper ".concat("create"===t||j?"":"hide"),children:Object(g.jsxs)("div",{className:"field-form",children:[Object(g.jsxs)("fieldset",{children:[Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{className:"field-label",children:"Name"}),Object(g.jsx)("input",{onChange:function(e){L(e.target.value)},value:S})]}),Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{className:"field-label",children:"Direction"}),Object(g.jsxs)("select",{id:"direction",className:"direction",onChange:function(e){k(e.target.value)},value:E,children:[Object(g.jsx)("option",{value:"Up",children:"Up"}),Object(g.jsx)("option",{value:"Down",children:"Down"})]})]}),Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{className:"field-label",children:"Route Id"}),Object(g.jsx)("input",{value:j?b&&b.id:s})]}),Object(g.jsxs)("div",{className:"field",children:[Object(g.jsx)("label",{className:"field-label",children:"Status"}),Object(g.jsxs)("select",{id:"status",className:"status",onChange:function(e){C(e.target.value)},value:T,children:[Object(g.jsx)("option",{value:"active",children:"Active"}),Object(g.jsx)("option",{value:"inactive",children:"Inactive"})]})]})]}),!!(l&&l.length>0)&&Object(g.jsx)("fieldset",{children:l.map((function(e,t){return Object(g.jsx)(N,{children:Object(g.jsx)(R,{setStops:o,index:e.id,setStopDetailList:n,stopDetailList:l,stop:e,setActualStops:r})})}))}),f&&Object(g.jsx)("fieldset",{className:"".concat(f?"":"hide"),children:Object(g.jsx)(N,{children:Object(g.jsx)(R,{setStops:o,index:V,setStopDetailList:n,stopDetailList:l,setActualStops:r,setIsNewStopRequested:v,isNewStopRequested:f,isNewStop:!0})})}),Object(g.jsxs)("div",{className:"btn-container",children:[Object(g.jsx)("div",{className:"".concat(f?"hide":"btn"),onClick:function(){o((function(e){return e+1})),v((function(e){return!e})),K((new Date).getTime())},children:"Add Stop"}),Object(g.jsx)("div",{onClick:function(){console.log({id:j?b&&b.id:s,name:S,routeDirection:E,routeStatus:T,stops:l});var e={id:j?b&&b.id:s,name:S,routeDirection:E,routeStatus:T,stops:l};_(j?D.routeAction.editRoute(e):D.routeAction.createRoute(e)),n([]),o(0),r(0),L(""),k(""),C("active"),u((new Date).getTime()),O&&O((function(e){return!e}))},className:"btn",children:"Submit"})]})]})})}),w=(s(68),function(e){var t=e.EditRoute,s=e.action,i=e.uniqueId,n=e.stops,c=e.setStops,a=e.stopDetailList,o=e.setStopDetailList,l=e.setActualStops,r=e.setUniqueId,u=e.routes,d=e.setIsEdit;return Object(g.jsx)(g.Fragment,{children:t&&Object(g.jsxs)("div",{className:"edit-container",children:[Object(g.jsx)(L,{action:s,uniqueId:i,stops:n,setStops:c,stopDetailList:a,setStopDetailList:o,setActualStops:l,setUniqueId:r,routes:u,isEdit:!0,EditRoute:t,setIsEdit:d}),Object(g.jsx)("div",{onClick:function(){d((function(e){return!e})),o([])},className:"btn",children:"close"})]})})}),y=(s(69),function(e){var t=e.routes,s=e.clickViewHandler,n=e.action,o=e.uniqueId,l=e.stops,r=e.setStops,u=e.stopDetailList,d=e.setStopDetailList,j=e.setActualStops,b=e.setUniqueId,O=Object(a.b)(),p=Object(i.useState)(!1),h=Object(c.a)(p,2),f=h[0],v=h[1];return Object(g.jsx)("div",{className:"view-container",children:Object(g.jsx)(g.Fragment,{children:t.map((function(e){return e&&Object(g.jsxs)("div",{className:"route-card",children:[Object(g.jsxs)("div",{className:"route-details",children:[Object(g.jsxs)("div",{className:"route-info",children:[Object(g.jsx)("label",{className:"title",children:"Route Id: "}),Object(g.jsx)("div",{className:"value",children:e.id})]}),Object(g.jsxs)("div",{className:"route-info",children:[Object(g.jsx)("label",{className:"title",children:"Route Name: "}),Object(g.jsx)("div",{className:"value",children:e.name})]}),Object(g.jsxs)("div",{className:"route-info",children:[Object(g.jsx)("label",{className:"title",children:"Route Direction: "}),Object(g.jsx)("div",{className:"value",children:e.routeDirection})]}),Object(g.jsxs)("div",{className:"route-info",children:[Object(g.jsx)("label",{className:"title",children:"Route Status: "}),Object(g.jsx)("div",{className:"value",children:e.routeStatus})]}),Object(g.jsxs)("div",{className:"route-info",children:[Object(g.jsx)("label",{className:"title",children:"No.of Stops: "}),Object(g.jsx)("div",{className:"value",children:e.stops&&e.stops.length})]})]}),Object(g.jsxs)("div",{class:"modify-container",children:[Object(g.jsx)("div",{class:"btn",onClick:function(){return s(e)},children:"View"}),Object(g.jsx)("div",{class:"btn",onClick:function(){return function(e){s(e),v((function(e){return!e}))}(e)},children:"Edit"}),Object(g.jsx)("div",{class:"btn",onClick:function(){return function(e){O(D.routeAction.deleteRoute(e))}(e)},children:"Delete"})]}),f&&Object(g.jsx)(w,{EditRoute:e,action:n,uniqueId:o,stops:l,setStops:r,stopDetailList:u,setStopDetailList:d,setActualStops:j,setUniqueId:b,routes:t,setIsEdit:v})]})}))})})}),E=s(38);function k(e){var t=[];return e&&e.length>0&&e.forEach((function(e){t.push(Object(f.a)(Object(f.a)({},e),{},{stops:JSON.stringify(e.stops)}))})),t}s(76);var I=[{label:"Route Id",key:"id"},{label:"Route Name",key:"name"},{label:"Route Direction",key:"routeDirection"},{label:"Route Status",key:"routeStatus"},{label:"Route Stops",key:"stops"}],A=function(e){var t=e.stops,s=e.setStopDetailList,n=e.setStops,o=e.stopDetailList,l=e.actualStops,r=e.setActualStops,u=(e.setRoute,e.route,e.targetRoute),d=e.setTargetRoute,j=Object(i.useRef)(),b=Object(i.useState)({}),O=Object(c.a)(b,2),p=O[0],v=O[1],x=Object(i.useState)(""),N=Object(c.a)(x,2),R=N[0],D=N[1],w=Object(i.useState)((new Date).getTime()),A=Object(c.a)(w,2),T=A[0],C=A[1],q=Object(a.c)((function(e){return console.log("State: ",e),e.routeReducer.routes})),U=Object(i.useState)(!1),V=Object(c.a)(U,2),K=V[0],_=V[1],F=function(e){return{point:{latitude:e.lat,longitude:e.lng}}},J=function(e,t){var s=document.createElement("div");s.className="marker",new m.a.Marker({element:s}).setLngLat(e).addTo(t)},z=function(e,t){console.log("stops list recieved ",e);var s={lng:e&&e.length>0&&e[0].longitude,lat:e&&e.length>0&&e[0].latitude},i=[],n=function(){(function(e){var t={key:"8LwBzLiXVxbsArt800KkbAiK5mT6O3hg",destinations:e.map((function(e){return F(e)})),origins:[F(s)]};return new Promise((function(s,i){S.a.services.matrixRouting(t).then((function(t){var i=t.matrix[0].map((function(t,s){return{location:e[s],drivingtime:t.response.routeSummary.travelTimeInSeconds}}));i.sort((function(e,t){return e.drivingtime-t.drivingtime}));var n=i.map((function(e){return e.location}));s(n)}))}))})(i).then((function(e){e.unshift(s),S.a.services.calculateRoute({key:"8LwBzLiXVxbsArt800KkbAiK5mT6O3hg",locations:e}).then((function(e){var s=e.toGeoJson();t.getLayer("route")&&(t.removeLayer("route"),t.removeSource("route")),t.addLayer({id:"route",type:"line",source:{type:"geojson",data:s},paint:{"line-color":"#4a90e2","line-width":3}})}))}))};e&&1===e.length?(console.log(e[0].latitude,e[0].longitude),J(new m.a.LngLat(Number(e[0].longitude),Number(e[0].latitude)),t)):e&&e.length>0&&(e.forEach((function(e){i.push(new m.a.LngLat(Number(e.longitude),Number(e.latitude))),J(new m.a.LngLat(Number(e.longitude),Number(e.latitude)),t)})),n())},B=q&&q.length>0?{data:k(q),headers:I,filename:"route_navigator.csv"}:{data:[],headers:I,filename:"route_navigator_empty.csv"};Object(i.useEffect)((function(){var e=0,t=0;o&&o.length>0?(e=o[0].longitude,t=o[0].latitude):u&&u.stops.length>0?(e=u.stops[0].longitude,t=u.stops[0].latitude):(e=77.59,t=12.97);var s=m.a.map({key:"8LwBzLiXVxbsArt800KkbAiK5mT6O3hg",container:j.current,stylesVisibility:{trafficIncidents:!0,trafficFlow:!0},center:[e,t],zoom:8});return v(s),o&&o.length>0?z(o,s):u&&u.stops&&z(u.stops,s),function(){return s.remove()}}),[l,JSON.stringify(u)]);var H=function(e){D(e),"create"===e?C((new Date).getTime()):"export"===e&&_((function(e){return!!(q&&q.length>0)}))};return Object(g.jsx)(g.Fragment,{children:p&&Object(g.jsxs)("div",{className:"map-container",children:[Object(g.jsx)("div",{ref:j,className:"mapDiv"}),Object(g.jsxs)("div",{className:"options-bar",children:[Object(g.jsx)("div",{onClick:function(){return H("create")},className:" btn ".concat("create"===R?"enabled":""),children:"Create"}),Object(g.jsx)("div",{onClick:function(){return H("view")},className:" btn ".concat("view"===R?"enabled":""),children:"View all Routes"}),Object(g.jsx)(E.CSVLink,Object(f.a)(Object(f.a)({},B),{},{className:"btn ".concat("export"===R?"enabled":""),onClick:function(){return H("export")},children:Object(g.jsx)("div",{children:"Export all Routes"})}))]}),Object(g.jsx)("div",{className:"create"===R?"show":"hide",children:Object(g.jsx)(L,{action:R,uniqueId:T,stops:t,setStops:n,stopDetailList:o,setStopDetailList:s,setActualStops:r,setUniqueId:C,routes:q})}),q&&q.length>0?Object(g.jsx)("div",{className:"view"===R?"show":"hide",children:Object(g.jsx)(y,Object(h.a)({routes:q,clickViewHandler:function(e){console.log(e),d(Object(f.a)({},e))},action:R,uniqueId:T,stops:t,setStops:n,stopDetailList:o,setStopDetailList:s,setActualStops:r,setUniqueId:C},"routes",q))}):"view"===R&&Object(g.jsx)("div",{children:"No Routes found!! \ud83d\ude15"}),K?"export"===R&&Object(g.jsx)("div",{children:"Data can be exported!! \ud83d\ude0a"}):Object(g.jsx)("div",{className:"export"===R?"show":"hide",children:"No data found to export!! \ud83d\ude15"})]})})};s(77);function T(){var e=Object(i.useState)(0),t=Object(c.a)(e,2),s=t[0],n=t[1],o=Object(i.useState)([]),l=Object(c.a)(o,2),r=l[0],u=l[1],d=Object(i.useState)(0),j=Object(c.a)(d,2),b=j[0],O=j[1],h=Object(i.useState)({}),f=Object(c.a)(h,2),v=f[0],m=f[1],x=Object(i.useState)(),S=Object(c.a)(x,2),N=S[0],R=S[1];return Object(g.jsx)(a.a,{store:p,children:Object(g.jsxs)("div",{className:"App",children:[Object(g.jsx)("div",{className:"header",children:"Route Navigator"}),Object(g.jsx)(A,{stops:s,setStops:n,stopDetailList:r,setStopDetailList:u,actualStops:b,setActualStops:O,setRoute:m,route:v,targetRoute:N,setTargetRoute:R})]})})}var C=document.getElementById("root");Object(n.createRoot)(C).render(Object(g.jsx)(T,{}))}},[[78,1,2]]]);
//# sourceMappingURL=main.a9bd7a34.chunk.js.map